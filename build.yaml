os:
  - ubuntu/trusty64
cassandra:
  - '3.10'
env:
  CSHARP_VERSION:
    - mono
    - netcore
build:
  - script: |
      # Set the Java paths (for CCM)
      export JAVA_HOME=$CCM_JAVA_HOME
      export PATH=$JAVA_HOME/bin:$PATH
      export SIMULACRON_PATH=$HOME/simulacron.jar

      # Define Cassandra runtime
      echo "==========setting cassandra version=========="
      export CASSANDRA_VERSION=$CCM_CASSANDRA_VERSION

      echo "==========copying ssl files to $HOME/ssl=========="
      cp -r /home/jenkins/ccm/ssl $HOME/ssl
 
      if [ $CSHARP_VERSION = 'mono' ]; then
          echo "==========csharp verion mono=========="
          # Define alias for Nuget
          nuget() {
                mono /home/jenkins/nuget/NuGet.exe "$@"
          }
          export -f nuget
          # Install the required packages
          export EnableNuGetPackageRestore=true
          msbuild /t:restore /v:m src/Cassandra.sln
      else
          # Install the required packages
          dotnet restore src
      fi

  - xunit:
    - "TestResult.xml"

